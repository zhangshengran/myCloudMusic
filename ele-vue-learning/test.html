<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
    <title>Document</title>
</head>

<body>
    <audio id="audio"
        src="http://m10.music.126.net/20190625150534/af075d72f2f9024739313c906b65daf0/ymusic/b1c4/b5de/74d0/9158ae4873e10b743790320db9ef9b29.mp3"
        controls></audio>
</body>
<script>
    let str = "[00:00.000] 作曲 : 黄家驹\n[00:00.666] 作词 : 黄家驹\n[00:02.000] 编曲 : Beyond / Kunihiko Ryo\n[00:03.000]\n[00:18.466] 今天我 寒夜里看雪飘过\n[00:25.110] 怀着冷却了的心窝漂远方\n[00:30.950] 风雨里追赶 雾里分不清影踪\n[00:37.229] 天空海阔你与我\n[00:40.291] 可会变（谁没在变）\n[00:43.440] 多少次 迎着冷眼与嘲笑\n[00:50.050] 从没有放弃过心中的理想\n[00:55.907] 一刹那恍惚 若有所失的感觉\n[01:02.133] 不知不觉已变淡\n[01:05.243] 心里爱（谁明白我）\n[01:08.801] 原谅我这一生不羁放纵爱自由\n[01:15.799] 也会怕有一天会跌倒\n[01:22.008] 背弃了理想 谁人都可以\n[01:28.276] 哪会怕有一天只你共我\n[01:34.102]\n[01:42.695] 今天我 寒夜里看雪飘过\n[01:49.284] 怀着冷却了的心窝漂远方\n[01:55.189] 风雨里追赶 雾里分不清影踪\n[02:01.405] 天空海阔你与我\n[02:04.535] 可会变（谁没在变）\n[02:08.014] 原谅我这一生不羁放纵爱自由\n[02:15.040] 也会怕有一天会跌倒\n[02:21.279] 背弃了理想 谁人都可以\n[02:27.531] 哪会怕有一天只你共我\n[02:33.633]\n[03:08.454] 仍然自由自我 永远高唱我歌\n[03:15.064] 走遍千里\n[03:19.739] 原谅我这一生不羁放纵爱自由\n[03:26.734] 也会怕有一天会跌倒\n[03:33.005] 背弃了理想 谁人都可以\n[03:39.257] 哪会怕有一天只你共我\n[03:45.496] 背弃了理想 谁人都可以\n[03:51.756] 哪会怕有一天只你共我\n[03:57.201] 原谅我这一生不羁放纵爱自由\n[04:04.204] 也会怕有一天会跌倒\n[04:10.456] 背弃了理想 谁人都可以\n[04:16.647] 哪会怕有一天只你共我\n[04:22.828]\n"

    let audio = document.querySelector('audio')
    let { timeArr, lycArr } = lycAnalysis(str);
    let hand = 0;
    let hand2 = 0;
    let current = {};

    setInterval(() => {
        current.time = timeArr[hand];
        current.lyc = lycArr[hand];
        console.log(audio.currentTime)
        if (audio.currentTime > current.time) {
            hand++;
            if (hand != hand2) {
                console.log(current.lyc);
                hand2 = hand
            }
        }

    }, 500)

    function lycAnalysis(lyc) {
        let lrcArr = lyc.split('\n')
        let timeArr = [];
        let lycArr = [];
        for (item of lrcArr) {
            let itemArr = item.split(']');
            lycArr.push(itemArr[1]);
            let time = timeToSecond(itemArr[0].slice(1))
            timeArr.push(time)

        }
        return { timeArr, lycArr }
    }


    function timeToSecond(time) {
        if (time) {
            let timeArr = time.split(':')
            let min = Number(timeArr[0]);
            let second = Number(timeArr[1]);
            return min * 60 + second;
        }


    }

// currentTime	设置或返回音频中的当前播放位置（以秒计）。
</script>

</html>